<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <title>Firebase Test Mode</title>
</head>
<body style="background: #222; color: #00ff00; font-family: monospace; padding: 20px;">

    <h2>=== FIREBASE DIAGNOSTIKA ===</h2>
    <div id="connection-status">Aloqa holati: Tekshirilmoqda...</div>
    <hr>
    <h3>Kelayotgan xom ma'lumotlar (Raw Data):</h3>
    <pre id="raw-data" style="background: #000; padding: 10px; border: 1px solid #00ff00;">
        Kutilmoqda...
    </pre>

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyCwhY9eF8gIO5Ew9MaYmzSbfKUs0wByOAM",
            authDomain: "bek-bola.firebaseapp.com",
            databaseURL: "https://bek-bola-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "bek-bola",
            storageBucket: "bek-bola.firebasestorage.app",
            messagingSenderId: "617804928629",
            appId: "1:617804928629:web:4402d65810cf3d30810a3c"
        };

        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // 1. Ulanishni tekshirish
        database.ref(".info/connected").on("value", (snap) => {
            const status = document.getElementById('connection-status');
            if (snap.val() === true) {
                status.innerText = "Aloqa holati: ✅ SERVERGA ULANDI";
                status.style.color = "#00ff00";
            } else {
                status.innerText = "Aloqa holati: ❌ ULANISH YO'Q";
                status.style.color = "red";
            }
        });

        // 2. Ma'lumotni o'qish va ekranga "xom" holatda chiqarish
        database.ref('chaqiruvlar/').on('value', (snapshot) => {
            const rawDisplay = document.getElementById('raw-data');
            const data = snapshot.val();
            
            if (data) {
                console.log("Ma'lumot keldi:", data);
                rawDisplay.innerText = JSON.stringify(data, null, 4);
            } else {
                rawDisplay.innerText = "Baza bo'sh yoki 'chaqiruvlar' papkasi topilmadi.";
            }
        }, (error) => {
            rawDisplay.innerText = "XATO: " + error.message;
        });
    </script>
</body>
</html>
